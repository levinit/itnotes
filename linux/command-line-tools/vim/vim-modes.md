# vim模式

共有6中基本模式和5中派生模式。

除正常模式和命令模式外，处于其他模式时，左下角会显示模式名字。

## 基本模式

### 正常模式（Normal-mode）

进入vim后所处的模式，可以执行一般的编辑器命令。

除了[Ex模式](#Ex模式（Ex mode）)中输入`visual`回到正常模式外，其他模式中均为按下<kbd>Esc</kbd>回到正常模式。



### 插入模式（Insert mode）

正常模式中按下各种编辑命令——`i`、`I`、`a`、`A`、`o`或`O`进入。

进入插入模式：

- 前插入insert

  - `i`  在光标前插入
  - `I`  在光标所在行首插入

- 后追加append

  - `a`  在光标后插入
  - `A`  在光标所在行尾插入

- 增加行

  - `o`  在光标所在行的下方插入新行
  -  `O`  在光标坐在行的上方插入新行

- 修改内容change

  使用`c`与其他命令组合，执行相应的删除动作后进入插入模式。

  如与`w`，`0`，`^`，`$`，`g_`组合（其中`c$`与`C`（`shift`+`c`作用相同）。

  - `cc`  删除当前行，光标置于行首并进入插入模式，同`S`

- 替换字符substitute

  - `s`  删除光标所在处的字符，并进入插入模式

    另外在normal模式中，使用`r`或`R`也可以进行替换（属于基本模式派生出的替换模式）。

  - `S`  删除光标所在行，并进入插入模式（可理解为替换掉整行字符）

  

### 命令模式（Command mode）

正常模式中按下`:`、`/`和`?`进入，执行一些指令（可用<kbd>Tab</kbd>补全命令）。

执行的命令若为vim编辑器的命令，该命令执行之后会自动返回正常模式（退出vim的命令除外）。

*因为历史原因，在命令行模式中执行的命令又被称为 Ex 命令，可执行 `:h ex-cmd-index`获取帮助。输入命令内容后回车执行之*。

进入命令模式：

- `:`   执行vim编辑器命令及其他工具的命令。

  - 临时执行shell命令：在shell命令前面加上`!`（如`:!ls`）
  - 强制执行vim命令：在vim命令后面加上`!`（如`:wq!`）

  

### 可视模式（Visual mode）

正常模式中按下各种可视命令进入可视模式。

可视模式中可使用方向键选择字符/行/块内容，选中区域会高亮，执行一个非移动命令会作用于高亮区域，并返回正常模式。

如果开启了鼠标选择功能（一般默认开启，如未开启可使用`:set mouse=a`，或在`/etc/vimrc`或`~/.vimrc`中添加`set mouse=a`），在normal模式下直接按住鼠标左键或右键拖选也可以进入可视模式（按下`v`的模式）。



提示：一些终端工具中，设置了set mouse=a 后，鼠标右键不能打开右键菜单，可以按住<kbd>Shift</kbd>后，再点击鼠标右键即可打开右键菜单。



进入可视模式：

- `v`  （字符）可视（visual)模式，文本选择以字符为单位的。

  - `viw`和`vaw`  选择当前单词（`iw` inner word只包含单词本身`aw` around word 包含单词前的空白字符）

  - `vi{char}`  选择成对字符中的内容

    例如`aa"xxx"zz` ，执行`vi"`选中双引号之间的内容。

- `V`  可视行（visual line)模式，文本选择以行为单位。

- <kbd>Ctrl</kbd><kbd>v</kbd>：可视块（visual block）模式，可以选择一个矩形内的文本。

  *注意：在 Windows 中，<kbd>Ctrl</kbd><kbd>v</kbd>可能已经被影射为粘贴操作，可以使用<kbd>Ctrl</kbd><kbd>q</kbd>：进入块可视化模式。*



### Ex模式（Ex mode）

正常模式中输入`Q`进入ex编辑器，可ex命令，使用参看ex编辑器文档。执行`visual`命令回到正常模式。

*vi底层是行编辑器ex，常用的一些vi命令源自ex命令。*

*ex编辑器中文本行从0开始排序。*



## 派生模式

分为操作符等待模式和4中插入类派生模式。

### 操作符等待模式

正常模式中，对于一个命令组合来说，执行完第一个操作后等待后一个“动作”的模式。

例如正常模式下执行`dw`，第一个`d`按下后就处于等待模式。



### 插入正常模式

**插入模式下**按下 <kbd>Ctrl</kbd><kbd>o</kbd> ，暂时进入正常模式，**执行完一条**正常模式下的vim命令之后将返回插入模式。



### 插入可视模式

**插入可视(块)模式下**按下 <kbd>Ctrl</kbd><kbd>o</kbd> ，暂时进入正常模式后，**再执行相关命令进入可视模式**，在可视区域选择取消后返回插入模式。

如果设置了鼠标拖选，在插入模式下鼠标拖选内容也会进入插入可视模式。



### 插入选择模式

激活了选择模式情况下，在插入模式下使用鼠标拖拽或者 shift 方向键进入选择模式，当选择区域取消后返回插入模式。



### 替换模式

正常模式下按`R`进入，在这个模式中可以做和插入模式一样的操作，该模式中输入的每个字符都会覆盖文本缓冲中已经存在的字符。

`r`为替换当前**单个字符**。